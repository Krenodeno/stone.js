!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Stone=t()}(function(){return function r(a,o,i){function s(e,t){if(!o[e]){if(!a[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(l)return l(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}n=o[e]={exports:{}},a[e][0].call(n.exports,function(t){return s(a[e][1][t]||t)},n,n.exports,r,a,o,i)}return o[e].exports}for(var l="function"==typeof require&&require,t=0;t<i.length;t++)s(i[t]);return s}({1:[function(t,e,n){"use strict";var o=t("./gettext.js").gettext,i=!1;function r(){if(i)for(var t=document.getElementsByTagName("*"),e=null,n=null,r=0,a=0,r=0;r<t.length;r++)if(t[r].hasAttribute("stonejs")){for(t[r].hasAttribute("stonejs-orig-string")||t[r].setAttribute("stonejs-orig-string",t[r].innerHTML),e={},n=t[r].attributes,a=0;a<n.length;a++)0===n[a].name.indexOf("stonejs-param-")&&(e[n[a].name.substr(14)]=n[a].value);t[r].innerHTML=o(t[r].getAttribute("stonejs-orig-string"),e)}}e.exports={enableDomScan:function(t){i=Boolean(t),r()},updateDomTranslation:r}},{"./gettext.js":2}],2:[function(t,e,n){"use strict";var u=t("./helpers.js"),f={},c=null,p={};function r(t,e,n){var r=t,n=("string"==typeof e&&(n=e,e=void 0),n||c);if(n&&f[n]&&f[n].messages&&f[n].messages[t]&&(n=f[n].messages[t],Array.isArray(n)&&0<n.length&&""!==n[0]?r=n[0]:Array.isArray(n["*"])&&0<n["*"].length&&""!==n["*"][0]&&(r=n["*"][0])),e)for(var a in e)r=r.replace(new RegExp("{"+a+"}","g"),e[a]);return r}function o(t,e,n,r,a){var o,i,s,l,g=1===n?t:e,e=("string"==typeof r&&(a=r,r=void 0),a||c);for(l in e&&f[e]&&f[e].messages&&(i=f[e]["plural-forms"],o=f[e].messages[t]),void 0!==i&&void 0!==o&&(p[e]||(p[e]=u.generatePluralFormsFunction(i)),a=p[e](n),Array.isArray(o)&&0<o.length?s=o:Array.isArray(o["*"])&&0<o["*"].length&&(s=o["*"]),void 0!==s[a])&&""!==s[a]&&(g=s[a]),void 0===(r=r||{}).n&&(r.n=n),r)g=g.replace(new RegExp("{"+l+"}","g"),r[l]);return g}function a(t,e,n,r){var a=e,r=("string"==typeof n&&(r=n,n=void 0),r||c);if(r&&f[r]&&f[r].messages&&f[r].messages[e]&&(r=f[r].messages[e],Array.isArray(r[t]))&&0<r[t].length&&""!==r[t][0]&&(a=r[t][0]),n)for(var o in n)a=a.replace(new RegExp("{"+o+"}","g"),n[o]);return a}function i(t,e,n,r,a,o){var i,s,l,g=1===r?e:n,n=("string"==typeof a&&(o=a,a=void 0),o||c);for(l in n&&f[n]&&f[n].messages&&(s=f[n]["plural-forms"],i=f[n].messages[e]),s&&i&&(p[n]||(p[n]=u.generatePluralFormsFunction(s)),Array.isArray(i[t]))&&0<i[t].length&&(o=p[n](r),i[t][o])&&""!==i[t][o]&&(g=i[t][o]),void 0===(a=a||{}).n&&(a.n=r),a)g=g.replace(new RegExp("{"+l+"}","g"),a[l]);return g}function s(t){for(var e=Object.getOwnPropertyNames(String.prototype),n=0;n<e.length;n++)"toString"!=e[n]&&("function"==typeof String.prototype[e[n]]?t[e[n]]=function(){var t=this.self.toString();return t[this.prop].apply(t,arguments)}.bind({self:t,prop:e[n]}):Object.defineProperty(t,e[n],{get:function(){return this.self.toString()[this.prop]}.bind({self:t,prop:e[n]}),enumerable:!1,configurable:!1}))}function l(t,e,n){this.toString=r.bind(this,t,e,n),s(this)}function g(t,e,n,r,a){this.toString=o.bind(this,t,e,n,r,a),s(this)}function d(t,e,n,r){this.toString=a.bind(this,t,e,n,r),s(this)}function h(t,e,n,r,a,o){this.toString=i.bind(this,t,e,n,r,a,o),s(this)}function y(t){c=t}e.exports={catalogs:f,LazyString:l,gettext:r,lazyGettext:function(t,e,n){return new l(t,e,n)},LazyNString:g,ngettext:o,lazyNgettext:function(t,e,n,r,a){return new g(t,e,n,r,a)},LazyPString:d,pgettext:a,lazyPgettext:function(t,e,n,r){return new d(t,e,n,r)},LazyNPString:h,npgettext:i,lazyNpgettext:function(t,e,n,r,a,o){return new h(t,e,n,r,a,o)},gettext_noop:function(t){return t},clearCatalogs:function(){for(var t in f)delete f[t]},addCatalogs:function(t){for(var e in t)if(f[e])for(var n in f[e]["plural-forms"]=t[e]["plural-forms"],t[e].messages)f[e].messages[n]=t[e].messages[n];else f[e]=t[e]},listCatalogs:function(){return Object.keys(f)},getLocale:function(){return c},setLocale:y,setBestMatchingLocale:function(t){t=t||u.extractLanguages();var e=Object.keys(f);y(u.findBestMatchingLocale(t,e))}}},{"./helpers.js":3}],3:[function(t,e,n){"use strict";function g(t){var e={lang:null,lect:null,q:1},n="";return-1<(n=-1<(t=t.toLowerCase().replace(/-/g,"_")).indexOf(";")?(2==(n=t.split(";")).length&&n[1].match(/^q=(1|0\.[0-9]+)$/)&&(e.q=parseFloat(n[1].split("=")[1])),n[0]||""):t).indexOf("_")?2==(n=n.split("_")).length?2==n[0].length&&(e.lang=n[0],2==n[1].length)&&(e.lect=n[1]):2==n[0].length&&(e=n[0]):2==n.length&&(e.lang=n),e}function r(t){t=/^\s*nplurals=\s*(\d+)\s*;\s*plural=([()n\s<>=\d&|%?!:+\-*\/]+);?[\s\\n]*$/g.exec(t);if(t)return t[2];throw new Error("plural forms are not valid")}e.exports={sendEvent:function(e,t){t=t||{};var n,r=null;try{r=new Event(e)}catch(t){(r=document.createEvent("Event")).initEvent(e,!0,!1)}for(n in t)r[n]=t[n];document.dispatchEvent(r)},parseLanguageCode:g,extractLanguages:function(t){if(!(t=void 0===t?navigator.language||navigator.userLanguage||navigator.systemLanguage||navigator.browserLanguage:t)||""===t)return["en"];for(var e,n,r=[],a=t.split(","),o=0;o<a.length;o++)(n=g(a[o])).lang&&r.push(n);if(0===r.length)return["en"];for(var r=r.sort(function(t,e){return e.q-t.q}),i=[],o=0;o<r.length;o++)e=r[o].lang,r[o].lect&&(e=(e+="_")+r[o].lect.toUpperCase()),i.push(e);return i},findBestMatchingLocale:function(t,e){Array.isArray(t)||(t=[t]);for(var n,r=[],a=0;a<e.length;a++)(n=g(e[a])).cat=e[a],r.push(n);for(var o=[],a=0;a<t.length;a++)o.push(g(t[a]));function i(t,e,n){if(null===t)return null;for(var r=0;r<n.length;r++){if("*"==e&&n[r].lang===t)return n[r];if(n[r].lang===t&&n[r].lect===e)return n[r]}}var s=null,l=0;for(a=0;a<o.length&&(((n=i(o[a].lang,o[a].lect,r))&&!s||n&&s&&n.lang===s.lang&&null===s.lect&&null!==n.lect)&&(s=n,l=a),!(s&&s.lang&&s.lect));a++);for(a=0;a<o.length;a++)if((n=i(o[a].lang,null,r))&&(!s||a<=l&&s.lang!==n.lang))return n.cat;for(a=0;a<o.length;a++)if((n=i(o[a].lang,o[a].lang,r))&&(!s||a<=l&&s.lang!==n.lang))return n.cat;if(s)return s.cat;for(a=0;a<o.length;a++)if(n=i(o[a].lang,"*",r))return n.cat;for(a=0;a<t.length;a++)if(0<=e.indexOf(t[a]))return t[a];return"c"},generatePluralFormsFunction:function(t){var t=r(t),e=Function("n","return "+t);return function(t){return Number(e(t))}},extractPluralExpression:r}},{}],4:[function(t,e,n){"use strict";var r=t("./helpers.js"),a=t("./gettext.js"),o=t("./dom.js");document.addEventListener("stonejs-autoload-catalogs",function(t){a.addCatalogs(t.catalog)},!0),e.exports={LazyString:a.LazyString,gettext:a.gettext,lazyGettext:a.lazyGettext,LazyNString:a.LazyNString,ngettext:a.ngettext,lazyNgettext:a.lazyNgettext,LazyPString:a.LazyPString,pgettext:a.pgettext,lazyPgettext:a.lazyPgettext,LazyNPString:a.LazyNPString,npgettext:a.npgettext,lazyNpgettext:a.lazyNpgettext,gettext_noop:a.gettext_noop,clearCatalogs:a.clearCatalogs,addCatalogs:a.addCatalogs,getLocale:a.getLocale,setLocale:function(t){a.setLocale(t),o.updateDomTranslation(),r.sendEvent("stonejs-locale-changed")},listCatalogs:a.listCatalogs,setBestMatchingLocale:a.setBestMatchingLocale,findBestMatchingLocale:r.findBestMatchingLocale,guessUserLanguage:function(){return r.extractLanguages()[0]},enableDomScan:o.enableDomScan,updateDomTranslation:o.updateDomTranslation}},{"./dom.js":1,"./gettext.js":2,"./helpers.js":3}]},{},[4])(4)});